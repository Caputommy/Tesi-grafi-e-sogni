\usepackage{drftcite}\chapter{Grafi multi-livello}

Come si \`e potuto vedere dal contenuto del Capitolo 1, le operazioni di contrazione e la costruzione di
gerarchie di grafi a pi\`u livelli siano concetti gi\`a ampiamente utilizzati e consolidati nella teoria dei grafi e
nelle sue applicazioni.
Tuttavia, ci\`o che non \`e stato ancora propriamente considerato nella letteratura esistente \`e la possibilit\`a di
definire e formalizzare una vera e propria struttura dati astratta che rappresenti un grafo multi-livello come
un'entit\`a a s\`e stante.
In questo capitolo saranno proposte definizioni e propriet\`a di base di una struttura dati per la rappresentazione
di gerarchie di grafi a pi\`u livelli, in cui sia possibile ottenere informazioni sull'intera struttura gerarchica in
relazione ai singoli grafi che la compongono.
In particolare, riprendendo dalla terminologia e dai concetti esistenti in letteratura,si proporranno definizioni
orginali di \textit{Grafi decontraibili} e di \textit{Grafi multi-livello}.

\subsection{Grafo decontraibile}\label{subsec:grafo-decontraibile}

    \paragraph{Definzione 1}(Grafo decontraibile) \newline
    \textit{Un \textbf{grafo decontraibile} \`e una quadrupla $G = (V, E, dec_V, dec_E)$ dove:
        \begin{itemize}
            \item $V$ \`e un insieme di elementi detti \textit{supernodi};
            \item $E \subseteq V \times V$ \`e un insieme di coppie ordinate di supernodi, dette \textit{superarchi};
            \item $dec_V : V \rightarrow \mathcal{G}_D$ \`e una biezione tale per cui $dec_V(v) = G_v$ \`e
            un grafo decontraibile rappresentato dal supernodo $v$;
            \item $dec_E : E \rightarrow (\mathcal{V} \times \mathcal{V})$ con $\mathcal{V} = \bigcup_{v \in V}\mathcal{V}_v$,
            \`e una biiezione tale per cui $\forall$ $ e = (u, v)$, $dec_E(e) = E_e \subseteq$ $\{(a, b)$ $\mid$ $a \in \mathcal{V}_u$ $\wedge$ $b \in \mathcal{V}_v\}$
            \`e un insieme di archi rappresentati da $e$.
        \end{itemize}}

    Si noti che \`e possibile usare una notazione basata su attributi alternativa a quella delle funzioni per
    descrivere le propriet\`a caratteristiche di nodi ed archi che rendono tale un grafo decontrabile.\newline
    In particolare, si pu\`o definire un grafo decontraibile come un normale grafo diretto sotto forma di coppia
    $(V, E)$ dove:
    \begin{itemize}
        \item $\forall$ $v \in V,$ \`e definito un attributo $v.dec = G_v$ dove $G_v = (\mathcal{V}_v, \mathcal{E}_v)$ \`e un grafo decontraibile
        rappresentato da $v$, quindi tale per cui $dec_V(v) = v.dec$.
        \item $\forall$ $e=(u, v)$  $\in E$, \`e definito una attributo $e.dec = E_e$ dove
        $\mathcal{E}_e \subseteq$ $\{(a, b)$ $\mid$ $a \in \mathcal{V}_u$ $\wedge$ $b \in \mathcal{V}_v\}$ \`e un insieme di archi rappresentati da $e$, quindi tale per cui $dec_E(e) = e.dec$.
    \end{itemize}

    Si noti inoltre che, dal momento in cui i grafi decontraibili sono a tutti gli effetti dei grafi, tutte le
    definizioni date sui grafi standard continuano a valere per i grafi decontraibili.

      \begin{figure}[H]
          \centering
          \include{TikzPictures/decontractible_graph_example}
          \label{fig:dec-graph-example}
      \end{figure}

    \paragraph{Definzione 2} (Contrazione di un grafo decontraibile) \newline
    \textit{Sia $G = (V, E)$ un grafo decontraibile, il grafo decontraibile
        $G\mathcal{'} = (\mathfrak{V}, \mathfrak{E})$ \`e una sua \textbf{contrazione} se e solamente se:
        \begin{enumerate}
            \item l'insieme $\{V_\alpha \mid \alpha \in \mathfrak{V}$, $dec_\mathfrak{V}(\alpha) = (V_\alpha, E_\alpha)\}$ \`e una partizione di $V$
            \item l'insieme $\{ E_\alpha \mid \alpha \in \mathfrak{V}$, $dec_\mathfrak{V}(\alpha) = (V_\alpha, E_\alpha)\} \cup \{ dec_\mathfrak{E}(\epsilon) \mid \epsilon \in \mathfrak{E}\}$
            \`e un ricoprimento di $E$ formato di insiemi due a due disgiunti, con $\emptyset \notin \{dec_E(\epsilon) \mid \epsilon \in \mathfrak{E}\}$.
        \end{enumerate}}

    Si noti, quindi, che la contrazione $G'$ del grafo decontraibile $G$ contiene tutte le informazioni
    necessarie a calcolare $G$.
    Infatti dalla definizione si ha:

    \begin{equation*}
        G = (\bigcup_{\alpha \in \mathfrak{V}} V_\alpha , (\bigcup_{\alpha \in \mathfrak{V}} E_\alpha \cup \bigcup_{\epsilon \in \mathfrak{E}} dec_\mathfrak{E}(\epsilon)) )
    \end{equation*}

      \begin{figure}[H]
          \centering
          \caption{Il grafo decontraibile a sinistra \`e una contrazione del grafo destra.}
          \label{fig:example2}
      \end{figure}

    Definiamo, inoltre, l'operatore unario $.^D : \mathcal{G}_D \rightarrow \mathcal{G}_D$ come l'operatore di
    \textbf{decontrazione completa} che, dato un grafo decontraibile $G = (V, E)$ restituisce il grafo decontrabile
    $G^D$ ottenuto dalla decontrazione di tutti i super-nodi e super-archi del grafo in input.

    \begin{equation*}
        G^D = (\bigcup_{v \in V} V_v , (\bigcup_{v \in V} E_v \cup \bigcup_{e \in E} dec_E(e)) )
    \end{equation*}

    Una contrazione di un grafo decontraibile $G$, pu\`o quindi essere alternativamente definta come un suo grafo
    quoziente decontrabile $G'$ la cui decontrazione completa $(G')^D$ \`e proprio $G$.
    \newline
    Si noti che, in generale, un grafo decontraibile $G$ pu\`o essere o meno una contrazione di $G^D$.

\begin{figure}[H]
    \centering
    \include{TikzPictures/non_contraction_example}
    \caption{Il grafo decontraibile a sinistra ottenuto come decontrazione completa del grafo destra NON \`e una
    sua contrazione, in quanto il super-nodo $a_3$ appartiene contemporaneamente a $V_a$ e $V_b$,
        e il super-arco $e_3$ viene decontratto in un insieme vuoto di archi.}
    \label{fig:example3}
\end{figure}

    \paragraph{Proposizione 1.1}
    Sia $G=(V, E)$ un grafo decontraibile e sia $G\mathcal{'} = (\mathfrak{V}, \mathfrak{E})$ una sua contrazione,
    sia $\alpha$ un super-nodo appartenente a $\mathfrak{V}$.
    Allora $dec_{\mathfrak{V}}(\alpha) = (V_\alpha, E_\alpha)$ \`e il sottografo di $G$ indotto da $V_\alpha$.
    \begin{equation*}
        dec_{\mathfrak{V}}(\alpha) = G[V_\alpha]
    \end{equation*}
    \paragraph{Dimostrazione}
    Sia $H = (W, F)$ il sottografo di $G = (V, E)$ indotto da $V_\alpha$ con
    $\alpha \in \mathfrak{V}$, per definizione di grafo indotto, $H$ deve essere definito sull'insieme di nodi
    $V_\alpha$, ovvero deve essere $W = V_\alpha$.
    Si vuole ora dimostrare che $F = E_\alpha$. \newline
    L'inclusione $F \subseteq E_\alpha$ pu\`o essere dimostrata notando che per definizione $H$,
    che \`e un grafo indotto da $V_\alpha$, si ha:
    \begin{equation*}
    (x, y) \in F \implies (x, y) \in E \quad \text{con} \quad x, y \in V_{\alpha}
    \end{equation*}
    Essendo che $\{ E_\alpha \mid \alpha \in \mathfrak{V}$, $dec_\mathfrak{V}(\alpha) = (V_\alpha, E_\alpha)\} \cup \{ dec_\mathfrak{E}(\epsilon) \mid \epsilon \in \mathfrak{E}\} $ \`e un ricoprimento di
    $E$, si nota che l'unico insieme del ricoprimento che pu\`o contenere archi definiti in $V_\alpha \times V_\alpha$ \`e proprio $E_\alpha$.
    Si conclude allora $(x, y) \in F \implies (x, y) \in E \implies (x, y) \in E_\alpha $. \newline
    L'inclusione $E_\alpha \subseteq F$ pu\`o essere dimostrata notando che per la propriet\`a delle contrazioni, per cui
    $\{ E_\alpha \mid \alpha \in \mathfrak{V}$, $dec_\mathfrak{V}(\alpha) = (V_\alpha, E_\alpha)\} \cup \{dec_\mathfrak{E}(\epsilon) \mid \epsilon \in \mathfrak{E}\} $ \`e una copertura di $E$, si ha:
    \begin{equation*}
    (u, v) \in E_\epsilon \implies (u, v) \in E
    \end{equation*}
    Essendo che  $(u, v) \in E_\alpha \implies (u, v) \in V_\alpha \times V_\alpha$ per definzione di $E_\alpha$, si deve avere $u, v \in V_\alpha$.
    Segue quindi $(u, v) \in E \wedge u,v \in V_\alpha \implies (u, v) \in F$.

    \newpage

    \subsection{Grafo multi-livello}\label{subsec:grafo-multi-livello}

    A partire dalla definizione di grafo decontraibile e di contrazione, pu\`o essere definita una struttura gerarchica
    a pi\`u livelli dove i grafi ai livelli inferiori possono essere ricorsivamente espansi a partire dai supernodi dei
    livelli superiori.
    Il concetto di grafo multi-livello prevede quindi una definizione bottom-up di tale struttura, indicandone il
    grafo inziale e gli schemi di contrazione secondo cui dei sotto-grafi sono collassati in singoli super-nodi,
    formando gerarchie di grafi decontraibili.

    \paragraph{Definzione 4} (Funzione di contrazione) \newline
    \textit{Una \textbf{funzione di contrazione} $f_C : \mathcal{G}_D \rightarrow \mathcal{G}_D$ \`e una funzione che dato un grafo
    decontraibile $G$ essa produce un nuovo grafo decontraibile $f_C(G) = G'$ che sia una contrazione di $G$.} \newline

    Una funzione di contrazione rappresenta quindi un particolare schema di contrazione dove dominio e codominio sono
    coincidenti e sono rappresentati dall'insieme dei grafi decontraibili.
    Questo vuol dire che \`e possibile comporre le funzioni di contrazione in sequenza a partire da un dato
    grafo decontraibile.

    \paragraph{Definzione 5} (Funzione di trasformazione naturale) \newline
    \textit{Definiamo \textbf{funzione di trasformazione naturale} $\eta$ una funzione che dato un grafo standard
        $H=(W,F)$, produce il corripondente grafo decontraibile $G = (V, E)$ con le seguenti propriet\`a:
        \begin{itemize}
            \item $dec_V(v) = (\emptyset, \emptyset)$ \quad $\forall$ $v\in V$
            \item $dec_E(e) = \emptyset$ \quad $\forall$ $e\in E$
            \item $H$ e $G$ sono isomorfi, ovvero esiste una biiezione $f_V : W \rightarrow V$ tale che
            \begin{equation*}
            (u, v) \in F \iff (f_V(u), f_V(v)) \in E
            \end{equation*}
        \end{itemize}}

    La funzione trasformazione naturale \`e quindi la funzione che permette di trasformare un dato grafo standard in un
    grafo decontraibile isomorfo per cui le due funzioni di decontrazione dei nodi e degli archi siano definite,
    seppur producano rispettivamente un grafo e un insieme di archi vuoto.
    Questo garantisce che il grafo decontraibile ottenuto non possa essere contrazione di alcun altro grafo
    decontraibile.

    \paragraph{Definzione 6} (Grafo multi-livello) \newline
    \textit{Un \textbf{grafo multi-livello} $M$ \`e una coppia $(G, \Gamma)$ dove:
        \begin{itemize}
            \item $G = (V, E)$ \`e un grafo
            \item $\Gamma$ \`e una sequenza $\langle f_{C_1}, f_{C_2}, .., f_{C_k} \rangle$ di funzioni di contrazione, ovvero tali che
            \begin{equation*}
                f_{C_i}(G_{i-1}) = G_i \text{ \`e una contrazione di } G_{i-1} \quad \forall i \in \{1, \ldots, k\}
            \end{equation*}
        \end{itemize}}

    Dato un grafo multi-livello $M = (G,\Gamma)$ con $\Gamma = \langle f_{C_1}, f_{C_2}, .., f_{C_k} \rangle$, la funzione che calcola il suo grafo decontraibile al livello k-esimo \`e definita come \newline
    \begin{equation*}
        con(M, k) =
        \left\{
        \begin{aligned}
            &f_{C_k}(con(M, k-1)) && \text{se } k > 0\\
            &\eta(G)  && \text{se } k = 0
        \end{aligned}
        \right\}
        = G_k
    \end{equation*}
    dove $\eta$ \`e la funzione di trasformazione naturale precedentemente defnita. \newline \newline
    Si noti che la funzione da applicare a $G$ per ottenere $G_{k}$ \`e $ f_{C_k} \circ f_{C_{k-1}} \circ \ldots \circ f_{C_1} \circ \eta $.

\newpage
Definiamo, inoltre, la funzione altezza $h$, sia per grafi multi-livello che per i suoi grafi decontraibili,
nel modo seguente:

\begin{itemize}
    \item $h : \mathcal{M} \rightarrow \mathbb{N}$, tale che $h(M) = k$, con $M = (G, \Gamma)$ e $k$ il numero di
    funzioni di contrazione in $\Gamma$.
    \item $h : \mathcal{G}_D \rightarrow \mathbb{N}$, tale che $h(G_i) = i$, con $i$ il numero di contrazioni
    necessarie per ottenere $G_i$ a partire da $\eta(G)$.
\end{itemize}

\begin{figure}[H]
    \include{TikzPictures/3d_layers_example}
    %example
    \caption{Esempio di grafi decontraibili $G_0, G_1, G_2$ di un grafo multi-livello di altezza 2 definito da funizoni
    di contrazione per cricche (contrazione da $G_0$ a $G_1$) e per componenti connesse (contrazione da $G_1$ a $G_2$).}
    \label{fig:example4}
\end{figure}

    \subsection{Algoritmo generico di trasformazione naturale}\label{subsec:algoritmo-generico-di-trasformazione-naturale}
    L'algoritmo generico di trasformazione naturale si occupa di definire un nuovo grafo decontraibile tramite
    l'ausilio della funzione biiettiva sopra definita $f_V$ che realizza l'isomorfismo.

    \input{Algoritmi/1-natural_transformation}

    Tramite l'ausilio di strutture dati con tempi di ricerca costanti, la complessit\`a della riga 10 si riduce a $O(1)$,
    e, di conseguenza, la complessit\`a dell'algoritmo \`e $\Theta(\mid V \mid+ \mid E \mid )$.





